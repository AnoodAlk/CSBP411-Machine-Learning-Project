
{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "f9417420",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from sklearn.model_selection import train_test_split\n",
    "import csv"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db3c4bb2",
   "metadata": {},
   "source": [
    "## Load Data in Pandas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "c1bc9125",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1297 entries, 0 to 1296\n",
      "Data columns (total 38 columns):\n",
      " #   Column                              Non-Null Count  Dtype  \n",
      "---  ------                              --------------  -----  \n",
      " 0   Year                                1296 non-null   float64\n",
      " 1   Mo                                  1296 non-null   float64\n",
      " 2   Dy                                  1296 non-null   float64\n",
      " 3   Hr                                  1295 non-null   float64\n",
      " 4   Mn                                  1295 non-null   float64\n",
      " 5   Sec                                 1292 non-null   float64\n",
      " 6   Tsu                                 265 non-null    float64\n",
      " 7   Vol                                 11 non-null     float64\n",
      " 8   Location Name                       1296 non-null   object \n",
      " 9   Latitude                            1296 non-null   float64\n",
      " 10  Longitude                           1296 non-null   float64\n",
      " 11  Focal Depth (km)                    1285 non-null   float64\n",
      " 12  Mag                                 1293 non-null   float64\n",
      " 13  MMI Int                             372 non-null    float64\n",
      " 14  Deaths                              524 non-null    float64\n",
      " 15  Death Description                   526 non-null    float64\n",
      " 16  Missing                             21 non-null     float64\n",
      " 17  Missing Description                 20 non-null     float64\n",
      " 18  Injuries                            691 non-null    float64\n",
      " 19  Injuries Description                746 non-null    float64\n",
      " 20  Damage ($Mil)                       171 non-null    float64\n",
      " 21  Damage Description                  1058 non-null   float64\n",
      " 22  Houses Destroyed                    342 non-null    float64\n",
      " 23  Houses Destroyed Description        496 non-null    float64\n",
      " 24  Houses Damaged                      381 non-null    float64\n",
      " 25  Houses Damaged Description          632 non-null    float64\n",
      " 26  Total Deaths                        534 non-null    float64\n",
      " 27  Total Death Description             534 non-null    float64\n",
      " 28  Total Missing                       21 non-null     float64\n",
      " 29  Total Missing Description           23 non-null     float64\n",
      " 30  Total Injuries                      701 non-null    float64\n",
      " 31  Total Injuries Description          756 non-null    float64\n",
      " 32  Total Damage ($Mil)                 179 non-null    float64\n",
      " 33  Total Damage Description            1064 non-null   float64\n",
      " 34  Total Houses Destroyed              344 non-null    float64\n",
      " 35  Total Houses Destroyed Description  498 non-null    float64\n",
      " 36  Total Houses Damaged                372 non-null    float64\n",
      " 37  Total Houses Damaged Description    619 non-null    float64\n",
      "dtypes: float64(37), object(1)\n",
      "memory usage: 385.2+ KB\n"
     ]
    }
   ],
   "source": [
    "df = pd.read_csv('earthquakesGED.csv')\n",
    "df.info() #check for useless features (Columns)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a5184e6e",
   "metadata": {},
   "source": [
    "## Drop Columns That Aren’t Useful"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "956feebc",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 1297 entries, 0 to 1296\n",
      "Data columns (total 18 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   Year                    1296 non-null   float64\n",
      " 1   Mo                      1296 non-null   float64\n",
      " 2   Dy                      1296 non-null   float64\n",
      " 3   Hr                      1295 non-null   float64\n",
      " 4   Mn                      1295 non-null   float64\n",
      " 5   Sec                     1292 non-null   float64\n",
      " 6   Tsu                     265 non-null    float64\n",
      " 7   Vol                     11 non-null     float64\n",
      " 8   Location Name           1296 non-null   object \n",
      " 9   Latitude                1296 non-null   float64\n",
      " 10  Longitude               1296 non-null   float64\n",
      " 11  Focal Depth (km)        1285 non-null   float64\n",
      " 12  Mag                     1293 non-null   float64\n",
      " 13  Total Deaths            534 non-null    float64\n",
      " 14  Total Missing           21 non-null     float64\n",
      " 15  Total Injuries          701 non-null    float64\n",
      " 16  Total Houses Destroyed  344 non-null    float64\n",
      " 17  Total Houses Damaged    372 non-null    float64\n",
      "dtypes: float64(17), object(1)\n",
      "memory usage: 182.5+ KB\n"
     ]
    }
   ],
   "source": [
    "cols = ['MMI Int','Deaths','Death Description','Missing','Missing Description','Injuries',\n",
    "        'Injuries Description','Damage ($Mil)','Damage Description','Houses Destroyed','Houses Destroyed Description',\n",
    "        'Houses Damaged','Houses Damaged Description','Total Death Description','Total Missing Description',\n",
    "        'Total Injuries Description','Total Damage ($Mil)','Total Damage Description',\n",
    "        'Total Houses Destroyed Description','Total Houses Damaged Description']\n",
    "df = df.drop(cols, axis=1)\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3929301f",
   "metadata": {},
   "source": [
    "## Replace null values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "baa63352",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Year</th>\n",
       "      <th>Mo</th>\n",
       "      <th>Dy</th>\n",
       "      <th>Hr</th>\n",
       "      <th>Mn</th>\n",
       "      <th>Sec</th>\n",
       "      <th>Tsu</th>\n",
       "      <th>Vol</th>\n",
       "      <th>Location Name</th>\n",
       "      <th>Latitude</th>\n",
       "      <th>Longitude</th>\n",
       "      <th>Focal Depth (km)</th>\n",
       "      <th>Mag</th>\n",
       "      <th>Total Deaths</th>\n",
       "      <th>Total Missing</th>\n",
       "      <th>Total Injuries</th>\n",
       "      <th>Total Houses Destroyed</th>\n",
       "      <th>Total Houses Damaged</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2000.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>34.0</td>\n",
       "      <td>12.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>INDIA-BANGLADESH BORDER:  MAHESHKHALI</td>\n",
       "      <td>22.132</td>\n",
       "      <td>92.771</td>\n",
       "      <td>33.0</td>\n",
       "      <td>4.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2000.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>56.4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CHINA:  LIAONING PROVINCE</td>\n",
       "      <td>40.498</td>\n",
       "      <td>122.994</td>\n",
       "      <td>10.0</td>\n",
       "      <td>5.1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>3600.0</td>\n",
       "      <td>8800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2000.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>23.0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>7.8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CHINA:  YUNNAN PROVINCE:  YAOAN COUNTY</td>\n",
       "      <td>25.607</td>\n",
       "      <td>101.063</td>\n",
       "      <td>33.0</td>\n",
       "      <td>5.9</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0</td>\n",
       "      <td>2528.0</td>\n",
       "      <td>41000.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2000.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>IRAN:  BARDASKAN, KASHMAR</td>\n",
       "      <td>35.288</td>\n",
       "      <td>58.218</td>\n",
       "      <td>33.0</td>\n",
       "      <td>5.3</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>300.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1292</th>\n",
       "      <td>2023.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>5871.0</td>\n",
       "      <td>0</td>\n",
       "      <td>INDONESIA:  BANDA SEA</td>\n",
       "      <td>-7.049</td>\n",
       "      <td>130.038</td>\n",
       "      <td>105.0</td>\n",
       "      <td>7.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>37.0</td>\n",
       "      <td>327.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1293</th>\n",
       "      <td>2023.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>INDIA: UTTAR PRADESH; NEPAL: SUDURPASHCHIM PRO...</td>\n",
       "      <td>29.597</td>\n",
       "      <td>81.652</td>\n",
       "      <td>25.0</td>\n",
       "      <td>5.6</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>42.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1294</th>\n",
       "      <td>2023.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>18.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>IRAN:  KHVOY (KHOY)</td>\n",
       "      <td>38.424</td>\n",
       "      <td>44.909</td>\n",
       "      <td>16.0</td>\n",
       "      <td>5.9</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1017.0</td>\n",
       "      <td>370.0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1295</th>\n",
       "      <td>2023.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>17.0</td>\n",
       "      <td>35.0</td>\n",
       "      <td>5873.0</td>\n",
       "      <td>0</td>\n",
       "      <td>TURKEY; SYRIA</td>\n",
       "      <td>37.166</td>\n",
       "      <td>37.042</td>\n",
       "      <td>17.0</td>\n",
       "      <td>7.8</td>\n",
       "      <td>21550.0</td>\n",
       "      <td>0</td>\n",
       "      <td>81500.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1296</th>\n",
       "      <td>2023.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>49.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>TURKEY; SYRIA</td>\n",
       "      <td>38.024</td>\n",
       "      <td>37.203</td>\n",
       "      <td>10.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1297 rows × 18 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Year   Mo    Dy    Hr    Mn   Sec     Tsu Vol  \\\n",
       "0        NaN  NaN   NaN   NaN   NaN   NaN       0   0   \n",
       "1     2000.0  1.0   3.0  22.0  34.0  12.6       0   0   \n",
       "2     2000.0  1.0  11.0  23.0  43.0  56.4       0   0   \n",
       "3     2000.0  1.0  14.0  23.0  37.0   7.8       0   0   \n",
       "4     2000.0  2.0   2.0  22.0  58.0   1.5       0   0   \n",
       "...      ...  ...   ...   ...   ...   ...     ...  ..   \n",
       "1292  2023.0  1.0   9.0  17.0  47.0  35.0  5871.0   0   \n",
       "1293  2023.0  1.0  24.0   8.0  58.0  32.0       0   0   \n",
       "1294  2023.0  1.0  28.0  18.0  14.0  45.0       0   0   \n",
       "1295  2023.0  2.0   6.0   1.0  17.0  35.0  5873.0   0   \n",
       "1296  2023.0  2.0   6.0  10.0  24.0  49.0       0   0   \n",
       "\n",
       "                                          Location Name  Latitude  Longitude  \\\n",
       "0                                                   NaN       NaN        NaN   \n",
       "1                 INDIA-BANGLADESH BORDER:  MAHESHKHALI    22.132     92.771   \n",
       "2                             CHINA:  LIAONING PROVINCE    40.498    122.994   \n",
       "3                CHINA:  YUNNAN PROVINCE:  YAOAN COUNTY    25.607    101.063   \n",
       "4                             IRAN:  BARDASKAN, KASHMAR    35.288     58.218   \n",
       "...                                                 ...       ...        ...   \n",
       "1292                              INDONESIA:  BANDA SEA    -7.049    130.038   \n",
       "1293  INDIA: UTTAR PRADESH; NEPAL: SUDURPASHCHIM PRO...    29.597     81.652   \n",
       "1294                                IRAN:  KHVOY (KHOY)    38.424     44.909   \n",
       "1295                                      TURKEY; SYRIA    37.166     37.042   \n",
       "1296                                      TURKEY; SYRIA    38.024     37.203   \n",
       "\n",
       "      Focal Depth (km)  Mag Total Deaths Total Missing Total Injuries  \\\n",
       "0                  NaN  NaN            0             0              0   \n",
       "1                 33.0  4.6            0             0              0   \n",
       "2                 10.0  5.1            0             0           30.0   \n",
       "3                 33.0  5.9          7.0             0         2528.0   \n",
       "4                 33.0  5.3          1.0             0           15.0   \n",
       "...                ...  ...          ...           ...            ...   \n",
       "1292             105.0  7.6            0             0              0   \n",
       "1293              25.0  5.6          4.0             0              0   \n",
       "1294              16.0  5.9          3.0             0         1017.0   \n",
       "1295              17.0  7.8      21550.0             0        81500.0   \n",
       "1296              10.0  7.5            0             0              0   \n",
       "\n",
       "     Total Houses Destroyed Total Houses Damaged  \n",
       "0                         0                    0  \n",
       "1                         0                100.0  \n",
       "2                    3600.0               8800.0  \n",
       "3                   41000.0                    0  \n",
       "4                     100.0                300.0  \n",
       "...                     ...                  ...  \n",
       "1292                   37.0                327.0  \n",
       "1293                      0                 42.0  \n",
       "1294                  370.0                    0  \n",
       "1295                      0                    0  \n",
       "1296                      0                    0  \n",
       "\n",
       "[1297 rows x 18 columns]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Tsu'] = df['Tsu'].fillna('0') # 0 for no tsunami\n",
    "df['Vol'] = df['Vol'].fillna('0') # 0 for no volcano \n",
    "df['Total Deaths'] = df['Total Deaths'].fillna('0') # 0 for no deaths\n",
    "df['Total Missing'] = df['Total Missing'].fillna('0') # 0 for no missing\n",
    "df['Total Injuries'] = df['Total Injuries'].fillna('0') # 0 for no missing\n",
    "df['Total Houses Destroyed'] = df['Total Houses Destroyed'].fillna('0') # 0 for no Houses Destroyed\n",
    "df['Total Houses Damaged'] = df['Total Houses Damaged'].fillna('0') # 0 for no Houses Damaged\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fd8f12a3",
   "metadata": {},
   "source": [
    "## Drop Rows With Missing Values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "0ab8bb4c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "Int64Index: 1283 entries, 1 to 1296\n",
      "Data columns (total 18 columns):\n",
      " #   Column                  Non-Null Count  Dtype  \n",
      "---  ------                  --------------  -----  \n",
      " 0   Year                    1283 non-null   float64\n",
      " 1   Mo                      1283 non-null   float64\n",
      " 2   Dy                      1283 non-null   float64\n",
      " 3   Hr                      1283 non-null   float64\n",
      " 4   Mn                      1283 non-null   float64\n",
      " 5   Sec                     1283 non-null   float64\n",
      " 6   Tsu                     1283 non-null   object \n",
      " 7   Vol                     1283 non-null   object \n",
      " 8   Location Name           1283 non-null   object \n",
      " 9   Latitude                1283 non-null   float64\n",
      " 10  Longitude               1283 non-null   float64\n",
      " 11  Focal Depth (km)        1283 non-null   float64\n",
      " 12  Mag                     1283 non-null   float64\n",
      " 13  Total Deaths            1283 non-null   object \n",
      " 14  Total Missing           1283 non-null   object \n",
      " 15  Total Injuries          1283 non-null   object \n",
      " 16  Total Houses Destroyed  1283 non-null   object \n",
      " 17  Total Houses Damaged    1283 non-null   object \n",
      "dtypes: float64(10), object(8)\n",
      "memory usage: 190.4+ KB\n"
     ]
    }
   ],
   "source": [
    "df = df.dropna()\n",
    "df.info()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d8052557",
   "metadata": {},
   "source": [
    "## Save csv File"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "21f370a1",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('GED-1.csv')\n",
    "df.to_excel('GED-2.xlsx')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
